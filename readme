# VNR OutPass Application

A comprehensive Gate Pass Management System for VNRVJIET with role-based access control, admin dashboard, bulk user management, QR-based validation, and SMS notifications.

---

## ğŸ› ï¸ Tech Stack

- **Frontend:** React + Vite + TypeScript + Bootstrap
- **Backend:** Express.js + TypeScript + Prisma
- **Database:** SQLite (local development) with Prisma ORM
- **Auth:** Google OAuth2 + JWT + HttpOnly Cookies
- **Features:** QR Code generation, SMS integration, Excel bulk upload, Admin panel

---

## ğŸš€ Setup Instructions

### 1. Clone & Install
```bash
git clone https://github.com/Joey-alwyn/vnr-outpass.git
cd vnr-outpass


### 2. Install Dependencies

cd backend
npm install

cd ../frontend
npm install


### 3. Set Up Environment Variables

Create a `.env` file in `backend/`:
```env
# JWT Configuration
JWT_SECRET=your-jwt-secret-key

# Google OAuth Configuration
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

# SMS Configuration (Optional)
SMS_API_KEY=your-sms-api-key
SMS_SENDER_ID=your-sender-id

# Server Configuration
PORT=3000
CORS_ORIGIN=http://localhost:5173
```

Create a `.env` file in `frontend/`:
```env
# API Configuration
VITE_API_BASE_URL=http://localhost:3000

# Google OAuth Configuration
VITE_GOOGLE_CLIENT_ID=your-google-client-id
```
```

### 4. Setup Database & Prisma

```bash
cd backend

# Generate Prisma client
npx prisma generate

# Run database migrations
npx prisma migrate dev

# Seed initial data (admin users, sample data)
npm run seed
```

âœ… This creates the SQLite database and seeds initial users + mentor mappings.

ğŸ”„ How to Add New Mentor/Student Mappings
Update src/scripts/seed.ts with only the new users and mappings like this:


// Add new users only
await prisma.user.createMany({
  data: [ ...newUsers ],
  skipDuplicates: true,
});

// Find users by email and map
const mentor = await prisma.user.findUnique({ where: { email: 'mentor@example.com' } });
const student = await prisma.user.findUnique({ where: { email: 'student@example.com' } });

await prisma.studentMentor.create({
  data: {
    studentId: student.id,
    mentorId: mentor.id
  }
});
âœ”ï¸ Re-run: 
npx ts-node src/scripts/seed.ts
>added seed script to json so - 'npm run seed' should be enough instead of the last command

> âš ï¸ Re-run `npx prisma generate` if schema changes
âš ï¸ Important Notes
You only need to run 'migrate dev' once per migration.
If you're not sure â€” run 'npx prisma migrate status' to check if you're behind.
Always follow it up with:
npx prisma generate

### 5. Start the App

```bash
# Backend
cd backend
npm run dev

# Frontend
cd frontend
npm run dev
```

Visit: `http://localhost:5173`

---

## ğŸ§ª Testing APIs (using REST Client)

Use `test.http` file in the root to:

* Login via `idToken`
* Apply for Gate Pass
* View Mentor Requests
* Approve/Reject Pass
* Security scan & verify

---

## ğŸ“ Project Structure

```
vnr-outpass/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts                    # Entry point
â”‚   â”‚   â”œâ”€â”€ config.ts                   # ENV config
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.controller.ts     # Admin panel, user management
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.controller.ts      # Authentication
â”‚   â”‚   â”‚   â”œâ”€â”€ student.controller.ts   # Student operations
â”‚   â”‚   â”‚   â”œâ”€â”€ mentor.controller.ts    # Mentor operations
â”‚   â”‚   â”‚   â””â”€â”€ security.controller.ts  # Security scanning
â”‚   â”‚   â”œâ”€â”€ middlewares/
â”‚   â”‚   â”‚   â”œâ”€â”€ role.middleware.ts      # Role-based access control
â”‚   â”‚   â”‚   â””â”€â”€ upload.middleware.ts    # File upload handling
â”‚   â”‚   â”œâ”€â”€ routes/                     # API routes by role
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ qr.util.ts             # QR code generation
â”‚   â”‚   â”‚   â”œâ”€â”€ sms.util.ts            # SMS notifications
â”‚   â”‚   â”‚   â”œâ”€â”€ excel.util.ts          # Excel processing
â”‚   â”‚   â”‚   â””â”€â”€ cron.ts                # Scheduled tasks
â”‚   â”‚   â””â”€â”€ scripts/
â”‚   â”‚       â””â”€â”€ seed.ts                # Database seeding
â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â”œâ”€â”€ schema.prisma              # Database schema
â”‚   â”‚   â”œâ”€â”€ gatepass.db                # SQLite database
â”‚   â”‚   â””â”€â”€ migrations/                # Database migrations
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.tsx                     # Main app with routing
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ admin/                  # Admin dashboard components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AdminDashboard.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UserManagement.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BulkAddModal.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ OutpassReports.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Layout.tsx              # Main layout
â”‚   â”‚   â”‚   â””â”€â”€ RequireRole.tsx         # Role protection
â”‚   â”‚   â”œâ”€â”€ pages/                      # Role-based pages
â”‚   â”‚   â”‚   â”œâ”€â”€ GatePassForm.tsx        # Student application
â”‚   â”‚   â”‚   â”œâ”€â”€ MentorRequests.tsx      # Mentor approval
â”‚   â”‚   â”‚   â”œâ”€â”€ SecurityScan.tsx        # QR scanning
â”‚   â”‚   â”‚   â”œâ”€â”€ AdminPanel.tsx          # Admin dashboard
â”‚   â”‚   â”‚   â””â”€â”€ HodPanel.tsx            # HOD panel
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â””â”€â”€ AuthContext.tsx         # Authentication context
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â””â”€â”€ admin.service.ts        # Admin API calls
â”‚   â””â”€â”€ package.json

```
## âœ… Completed Features

### ğŸ” Authentication & Authorization
- Google OAuth2 integration (SSO)
- Role-based access control (Student, Mentor, HOD, Security, Admin)
- JWT token management with HttpOnly cookies
- Protected routes and API endpoints

### ğŸ‘¨â€ğŸ’¼ Admin Panel
- **User Management**: Create, edit, delete users
- **Bulk User Upload**: Excel file import with auto-mapping
- **Student-Mentor Mapping**: Visual mapping interface
- **Role Assignment**: Dynamic role management
- **Dashboard Analytics**: User statistics and insights

### ğŸ“ Student Features
- Gate pass application form
- Application status tracking
- QR code download for approved passes
- Mobile-responsive interface

### ğŸ‘¨â€ğŸ« Mentor Features
- View pending student requests
- Approve/reject gate pass applications  
- Student-mentor relationship management
- Notification system for new requests

### ğŸ›¡ï¸ Security Features
- QR code scanning interface
- Pass validation and verification
- Invalid pass detection
- Security guard dashboard

### ğŸ“Š HOD Features
- Departmental oversight
- Advanced reporting and analytics
- Bulk approval capabilities
- Administrative controls

### ğŸ”§ Technical Features
- SQLite database with Prisma ORM
- SMS notification integration
- Excel file processing and validation
- QR code generation and validation
- Responsive mobile design
- Real-time status updates

## ğŸ”œ Future Enhancements

| Feature                                    | Priority | Status      |
| ------------------------------------------ | -------- | ----------- |
| **Email Notifications**                    | High     | â³ Planned  |
| **Advanced Analytics Dashboard**           | Medium   | â³ Planned  |
| **Mobile App (React Native)**             | Medium   | ğŸ”œ Future   |
| **Batch QR Operations**                   | Low      | ğŸ”œ Future   |
| **Integration with College ERP**          | Low      | ğŸ”œ Future   |
| **Automated Reports Generation**          | Medium   | ğŸ”œ Future   |
| **Multi-language Support**               | Low      | ğŸ”œ Future   |

## ğŸš€ Deployment

### Backend Deployment
```bash
# Build for production
npm run build

# Start production server  
npm start
```

### Frontend Deployment
```bash
# Build for production
npm run build

# Serve static files
# Deploy dist/ folder to your hosting service
```

### Database Backup
```bash
# Backup SQLite database
cp prisma/gatepass.db backup/gatepass_backup_$(date +%Y%m%d).db

# Restore from backup
cp backup/gatepass_backup_YYYYMMDD.db prisma/gatepass.db
```


## ğŸ‘¥ Default Seeded Accounts

| Role     | Email                        | Password/Access | Notes                    |
| -------- | ---------------------------- | --------------- | ------------------------ |
| **Admin**    | `admin@vnrvjiet.in`          | Google OAuth    | Full system access       |
| **HOD**      | `hod@vnrvjiet.in`            | Google OAuth    | Department management    |
| **Mentor**   | `mentor@vnrvjiet.in`         | Google OAuth    | Student supervision      |
| **Security** | `security@vnrvjiet.in`       | Google OAuth    | Gate pass verification   |
| **Student**  | `22071a0508@vnrvjiet.in`     | Google OAuth    | Sample student account   |

### ğŸ§ª Testing Workflow

1. **Admin Login**: Access admin panel â†’ User Management â†’ Bulk Upload
2. **Student Login**: Apply for gate pass â†’ Wait for mentor approval
3. **Mentor Login**: Review pending requests â†’ Approve/reject applications  
4. **Security Login**: Scan QR codes â†’ Verify gate pass validity

### ğŸ“± Mobile Testing
- All interfaces are mobile-responsive
- Test on different screen sizes
- QR scanning works on mobile devices

---

good luck lamavo if u are reading this